<!DOCTYPE html>
<html>
    <head>
        <script>
             if (!(localStorage.getItem("jsonstring") === null)) {
                localStorage.removeItem("jsonstring");
             }
            function alert_me() {
                var userinfoobj = {};
                userinfoobj.firstname = document.getElementById("firstname").value;
                userinfoobj.lastname = document.getElementById("lastname").value;
                userinfoobj.email = document.getElementById("email").value;
                if(typeof(Storage) !== "undefined") {
                    if (localStorage.getItem("jsonstring") === null) {

                        localStorage.setItem("jsonstring", JSON.stringify(userinfoobj));
                    } else {
                        localStorage.setItem("jsonstring", localStorage.getItem("jsonstring") + "," + JSON.stringify(userinfoobj));
                    }
                    alert(localStorage.getItem("jsonstring"));
                    } else {
                    alert("Sorry, your browser does not support web storage...");
                }

                var jsonDataObj = JSON.parse("[" + localStorage.getItem("jsonstring") + "]");
                writehtml(jsonDataObj);
            }

            // This function takes the ojbects value passed to it and generates the page's additional HTML.
            // For loop isused to access the value of each key/value pair and generates the table HTML.
            function writehtml (jsonDataObj){
                var htmltable = "<table>";
                htmltable += "<tr><th>User Name</th><th>Email Address</th><th>Phone Number</th></tr>";
                for (var inc = 0 ; inc < jsonDataObj.length ; inc++){
                    htmltable += "<tr><td>" + jsonDataObj[inc].name + "</td><td>" + jsonDataObj[inc].email + "</td><td>" + jsonDataObj[inc].phone + "</td></tr>";
                }
                htmltable += "</table>";
                document.getElementById("jsonstringify").innerHTML = JSON.stringify(jsonDataObj);
                document.getElementById("movieTable").innerHTML = htmltable;
            }
            
        </script>

        <style>
            table {
                border-collapse: collapse;
            }
            td, th {
                border: 1px solid black;
                padding: 8px;
            }
        </style>
    </head>
<body>

<h1 style="text-align: center">Topic 5 - Local Storage API, Storing and Retrieving Simple Data, Arrays, Associative Arrays, and Objects</h1>
<br>
<h3>Info about web form</h3>

<h3>Web Form</h3>
<p>
    First name:<br>
    <input type="text" name="firstname" id="firstname">
    <br>
    Last name:<br>
    <input type="text" name="lastname" id="lastname">
    <br>
    E-Mail:<br>
    <input type="text" name="email" id="email">
    <br><br>
    <button onclick="alert_me();">Save</button>
</p>
<p id="userTable"></p>
<p id="jsonstringify"></p>
</body>
</html>